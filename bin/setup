#!/usr/bin/env ruby

puts '== Instalando dependÃªncias =='
system 'gem install bundler --conservative'
system('bundle check') || system('bundle install')

require 'sqlite3'

puts "\n== Criando banco de dados =="

begin
db = SQLite3::Database.open "db/database.db"
db.execute <<~SQL
CREATE TABLE IF NOT EXISTS Diario(
    ID INTEGER PRIMARY KEY AUTOINCREMENT,
    TITULO varchar(100),
    CATEGORIA varchar(100),
    DESCRICAO varchar(255),
    STATUSDIARIO varchar(30)
);
SQL

rescue SQLite3::Exception => e
    puts e
ensure
    db.close if db
end